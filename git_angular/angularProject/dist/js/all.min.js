angular.module("myApp",["ui.router"]).config(["$stateProvider","$urlRouterProvider","$httpProvider",function(e,t,o){t.otherwise("/home"),e.state("home",{url:"/home",templateUrl:"views/home.html",controller:"HomeController"}).state("reg",{url:"/reg",templateUrl:"views/reg.html",controller:"RegController"}).state("login",{url:"/login",templateUrl:"views/login.html",controller:"LoginController"}).state("list",{url:"/list",templateUrl:"views/list.html",controller:"ListController"}),o.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8";var n=function(e){var t,o,l,s,a,r,c="";for(t in e)if((o=e[t])instanceof Array)for(r=0;r<o.length;++r)s=o[r],(a={})[t+"["+r+"]"]=s,c+=n(a)+"&";else if(o instanceof Object)for(l in o)s=o[l],(a={})[t+"["+l+"]"]=s,c+=n(a)+"&";else void 0!==o&&null!==o&&(c+=encodeURIComponent(t)+"="+encodeURIComponent(o)+"&");return c.length?c.substr(0,c.length-1):c};o.defaults.transformRequest=[function(e){return angular.isObject(e)&&"[object File]"!==String(e)?n(e):e}]}]),setTimeout(function(){function e(){n[r].className="",l[r].className="",++r==n.length&&(r=0),n[r].className="current",l[r].className="sel"}function t(){n[r].className="",l[r].className="",-1==--r&&(r=n.length-1),n[r].className="current",l[r].className="sel"}var o=document.getElementById("carousel"),n=document.getElementById("content").getElementsByTagName("div"),l=document.getElementById("control").getElementsByTagName("li"),s=document.getElementById("aL"),a=document.getElementById("aR"),r=0,c=setInterval(e,2e3);o.onmouseover=function(){clearInterval(c),s.style.display="block",a.style.display="block"},o.onmouseout=function(){c=setInterval(e,2e3),s.style.display="none",a.style.display="none"};for(var i=0;i<l.length;i++)l[i]._index=i,l[i].onclick=function(){l[r].className="",n[r].className="",this.className="sel",n[this._index].className="current",r=this._index};a.onclick=function(){e()},s.onclick=function(){t()}},1),angular.module("myApp").controller("HomeController",["$scope","$http",function(e,t){e.slides=[],e.hot=[],e.new=[],e.unit=[],t.get("http://localhost:3000/IndexInfo").then(function(t){console.log(t),e.slides=t.data.result.slides,e.hot=t.data.result.hot,e.new=t.data.result.new,e.unit=t.data.result.unit},function(e){console.log(e)})}]),angular.module("myApp").controller("ListController",["$scope","$http",function(e,t){e.arr=[],e.arrtype=["全部","微电影","电影","电视剧","戏曲","话剧","书画","相声","戏剧","音乐剧","其他"],e.changePage=function(t){e.page=t,e.getListData()};var o={init:function(){e.cid=0,e.staus=0,e.page=1,e.count=9,e.getListData()}};e.getListData=function(){t({url:"http://localhost:3000/prolist",method:"get",params:{cid:e.cid,status:e.staus,page:e.page,count:e.count}}).then(function(t){console.log(t);for(var o=Math.ceil(t.data.result.countAll/t.data.result.count),n=0;n<o;n++)e.arr.push(n+1);console.log(o),e.listData=t.data.result.list},function(e){console.log(e)})},e.choose=function(t){console.log("...."+t),e.orderna=t},e.allfn=function(){e.orderna=""},o.init()}]),angular.module("myApp").controller("LoginController",["$scope","$http","$state","$rootScope",function(e,t,o,n){e.login=function(){t({url:"http://localhost:3000/user/login",method:"post",data:{phone:e.phone,password:e.password}}).then(function(e){console.log(e),n.loginUser=e.data.result.username,o.go("home")},function(e){console.log(e)})}}]),angular.module("myApp").controller("RegController",["$scope","$http",function(e,t){e.reg=function(o){console.log("isOk"),o?t({url:"http://localhost:3000/user/reg",method:"post",data:{phone:e.phone,password:e.password,passwordRepeat:e.passwordRepeat}}).then(function(e){console.log(e)},function(e){console.log(e)}):console.log("表单有不正确的输入项")}}]);